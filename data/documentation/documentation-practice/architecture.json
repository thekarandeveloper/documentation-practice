{"identifier":{"url":"doc:\/\/com.rachna.docs31212\/documentation\/documentation-practice\/architecture","interfaceLanguage":"swift"},"hierarchy":{"paths":[["doc:\/\/com.rachna.docs31212\/documentation\/Documentation"]]},"metadata":{"role":"article","title":"Swipe iOS & KMM Architecture Documentation","roleHeading":"Article"},"sections":[],"abstract":[{"type":"strong","inlineContent":[{"type":"text","text":"Project"}]},{"type":"text","text":": Swipe iOS Application"}],"kind":"article","schemaVersion":{"patch":0,"minor":3,"major":0},"primaryContentSections":[{"kind":"content","content":[{"type":"heading","level":2,"anchor":"overview","text":"Overview"},{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Last Updated"}]},{"type":"text","text":": 2025-11-21"}]},{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Current Branch"}]},{"type":"text","text":": "},{"code":"staging","type":"codeVoice"}]},{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Architecture Style"}]},{"type":"text","text":": Hybrid SwiftUI + Kotlin Multiplatform Mobile (KMM)"}]},{"type":"thematicBreak"},{"type":"heading","level":2,"anchor":"Table-of-Contents","text":"Table of Contents"},{"type":"orderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"identifier":"#project-structure","isActive":true,"type":"reference"}]}]},{"content":[{"inlineContent":[{"type":"reference","identifier":"#architectural-patterns","isActive":true}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"identifier":"#ios-architecture","isActive":true,"type":"reference"}]}]},{"content":[{"inlineContent":[{"type":"reference","identifier":"#kmm-architecture","isActive":true}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"identifier":"#data-flow","isActive":true,"type":"reference"}]}]},{"content":[{"inlineContent":[{"type":"reference","identifier":"#module-dependencies","isActive":true}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"identifier":"#key-components","isActive":true,"type":"reference"}]}]},{"content":[{"inlineContent":[{"type":"reference","identifier":"#third-party-dependencies","isActive":true}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"identifier":"#build-configuration","isActive":true,"type":"reference"}]}]},{"content":[{"inlineContent":[{"type":"reference","identifier":"#security","isActive":true}],"type":"paragraph"}]}]},{"type":"thematicBreak"},{"type":"heading","level":2,"anchor":"Project-Structure","text":"Project Structure"},{"type":"codeListing","code":["swipe-ios\/","├── Swipe\/                              # iOS Application","│   ├── Swipe.xcodeproj                # Xcode project","│   ├── Swipe.xcworkspace              # Workspace (includes Pods)","│   ├── Podfile                        # CocoaPods dependencies","│   ├── Swipe\/                         # iOS source code","│   │   ├── iOSApp.swift              # App entry point","│   │   ├── Presentation\/             # UI Layer","│   │   │   ├── Splash\/","│   │   │   ├── Account\/              # Login, OTP","│   │   │   ├── Navigation\/           # Navigation system","│   │   │   ├── Home\/                 # Main app screens","│   │   │   │   ├── Dashboard\/","│   │   │   │   ├── Bills\/            # Invoices, Purchases","│   │   │   │   ├── Products\/         # Product management","│   │   │   │   ├── Parties\/          # Customers, Vendors","│   │   │   │   └── More\/             # Settings","│   │   │   ├── CustomViews\/          # 68+ reusable components","│   │   │   ├── Theme\/                # Design system","│   │   │   ├── IAP\/                  # In-App Purchases","│   │   │   └── Reports\/              # Native reports","│   │   ├── Common\/                   # Utilities, constants","│   │   ├── Extensions\/               # Swift extensions (30+)","│   │   ├── System\/                   # System managers","│   │   ├── Network\/                  # Network monitoring","│   │   ├── Security\/                 # Keychain","│   │   ├── Analytics\/                # Firebase, Clarity","│   │   └── Localisation\/            # i18n","│   ├── NotificationService\/          # Rich notifications extension","│   ├── SwipeWidget\/                  # Home screen widget","│   └── SmartechNSEContent\/          # Smartech notifications","│","└── shared\/                            # KMM Shared Module","    ├── build.gradle.kts              # Kotlin build config","    └── src\/","        ├── commonMain\/kotlin\/in\/getswipe\/","        │   ├── di\/                   # Dependency Injection","        │   │   └── KoinDI.kt        # DI configuration","        │   ├── common\/              # Common utilities","        │   │   ├── Constants.kt","        │   │   ├── SharedPreferences.kt","        │   │   └── Utils.kt (expect\/actual)","        │   ├── data\/                # Data Layer","        │   │   ├── viewmodel\/       # 37 ViewModels","        │   │   ├── repository\/      # 34 Repository impls","        │   │   ├── remote\/          # 33 API services","        │   │   ├── network\/         # Network utilities","        │   │   ├── events\/          # UI Events","        │   │   └── dummy\/           # Test data","        │   └── domain\/              # Domain Layer","        │       └── model\/","        │           ├── repository\/  # Repository interfaces","        │           ├── data\/        # Data models","        │           ├── requests\/    # 173 API request models","        │           └── responses\/   # 165 API response models","        ├── iosMain\/kotlin\/in\/getswipe\/","        │   └── common\/              # iOS platform implementations (7 files)","        └── androidMain\/kotlin\/in\/getswipe\/","            └── common\/              # Android platform implementations (8 files)"],"syntax":null},{"type":"thematicBreak"},{"type":"heading","level":2,"anchor":"Architectural-Patterns","text":"Architectural Patterns"},{"type":"heading","level":3,"anchor":"1-Clean-Architecture","text":"1. Clean Architecture"},{"type":"paragraph","inlineContent":[{"type":"text","text":"The application follows Clean Architecture principles with clear separation of concerns across three layers:"}]},{"type":"codeListing","code":["┌─────────────────────────────────────────────────┐","│                  UI Layer                       │","│              (SwiftUI Views)                    │","│  - Pure presentation logic                      │","│  - No business logic                            │","│  - Observes ViewModels                          │","└─────────────────┬───────────────────────────────┘","                  │","┌─────────────────▼───────────────────────────────┐","│            Presentation Layer                   │","│          (KMM + Swift ViewModels)               │","│  - Business logic orchestration                 │","│  - State management                             │","│  - UI event handling                            │","└─────────────────┬───────────────────────────────┘","                  │","┌─────────────────▼───────────────────────────────┐","│              Domain Layer                       │","│         (Kotlin Interfaces & Models)            │","│  - Repository interfaces                        │","│  - Domain models                                │","│  - Business rules                               │","└─────────────────┬───────────────────────────────┘","                  │","┌─────────────────▼───────────────────────────────┐","│               Data Layer                        │","│        (Repository Implementations)             │","│  - API services (Ktor)                          │","│  - Local persistence (Realm)                    │","│  - Data mapping                                 │","└─────────────────────────────────────────────────┘"],"syntax":null},{"type":"heading","level":3,"anchor":"2-MVVM-Model-View-ViewModel","text":"2. MVVM (Model-View-ViewModel)"},{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"ViewModel Hierarchy:"}]}]},{"code":["\/\/ KMM ViewModel (Kotlin)","class ProductsViewmodel : ViewModel() {","    val products: MutableLiveData<ResourceState<List<Product>, Exception>>","","    fun onUIEvent(events: ProductsUIEvents) {","        when(events) {","            is FetchProducts -> fetchProducts()","            is DeleteProduct -> deleteProduct(events.id)","        }","    }","}","","\/\/ Swift ViewModel Extension","class ProductsViewmodel: shared.ProductsViewmodel {","    @Published var selectedProduct: Product? = nil","    @Published var shouldNavigateToProductDetailsScreen: Bool = false","","    \/\/ iOS-specific functionality","    override init() {","        super.init()","        initObservers()","    }","","    func initObservers() {","        attachObservers()","    }","}","","\/\/ SwiftUI View","struct ProductsView: View {","    @EnvironmentViewModel var productsViewmodel: ProductsViewmodel","","    var body: some View {","        ResourceStateHandler(","            resourceState: productsViewmodel.products,","            onLoadedData: { products in","                ProductList(products: products)","            }","        )","        .onAppear {","            productsViewmodel.onUIEvent(events: FetchProducts())","        }","    }","}"],"type":"codeListing","syntax":"swift"},{"type":"heading","level":3,"anchor":"3-Repository-Pattern","text":"3. Repository Pattern"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Every data source is abstracted behind a repository interface:"}]},{"type":"codeListing","code":["\/\/ Domain Layer - Interface","interface ProductsRepository {","    suspend fun getProducts(request: GetProductsRequest): ResourceState<ProductsResponse, Exception>","    suspend fun createProduct(request: CreateProductRequest): ResourceState<CreateProductResponse, Exception>","}","","\/\/ Data Layer - Implementation","class ProductsRepositoryImpl(","    private val productsApi: ProductsApi",") : ProductsRepository {","    override suspend fun getProducts(request: GetProductsRequest): ResourceState<ProductsResponse, Exception> {","        return try {","            val response = productsApi.getProducts(request)","            NetworkUtils.handleResponse(response)","        } catch (e: Exception) {","            ResourceState.failed(e)","        }","    }","}","","\/\/ API Service","class ProductsApi(private val httpClient: HttpClient) {","    suspend fun getProducts(request: GetProductsRequest): HttpResponse {","        return httpClient.post {","            url(Constants.Endpoints.GET_PRODUCTS)","            setBody(request)","        }","    }","}"],"syntax":"kotlin"},{"type":"heading","level":3,"anchor":"4-State-Management-Patterns","text":"4. State Management Patterns"},{"type":"heading","level":4,"anchor":"ResourceState-Pattern","text":"ResourceState Pattern"},{"type":"paragraph","inlineContent":[{"type":"text","text":"All API responses are wrapped in "},{"code":"ResourceState<T, E>","type":"codeVoice"},{"type":"text","text":":"}]},{"type":"codeListing","code":["sealed class ResourceState<out T, out E> {","    class Loading<T, E> : ResourceState<T, E>()","    data class Success<T, E>(val data: T) : ResourceState<T, E>()","    data class Failed<T, E>(val error: E) : ResourceState<T, E>()","    class Empty<T, E> : ResourceState<T, E>()","}"],"syntax":"kotlin"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Usage in SwiftUI:"}]},{"code":["ResourceStateHandler(","    resourceState: viewModel.companyDetails,","    onLoadingState: { LoadingView() },","    onErrorState: { error in ErrorView(error: error) },","    onLoadedData: { data in ContentView(data: data) }",")"],"type":"codeListing","syntax":"swift"},{"type":"heading","level":4,"anchor":"UI-Events-Pattern","text":"UI Events Pattern"},{"type":"paragraph","inlineContent":[{"type":"text","text":"User interactions are modeled as sealed classes:"}]},{"code":["sealed class ProductsUIEvents {","    object FetchProducts : ProductsUIEvents()","    data class DeleteProduct(val id: Int) : ProductsUIEvents()","    data class UpdateProduct(val product: Product) : ProductsUIEvents()","}"],"type":"codeListing","syntax":"kotlin"},{"level":3,"anchor":"5-Dependency-Injection-Koin","type":"heading","text":"5. Dependency Injection (Koin)"},{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"text":"DI Configuration (","type":"text"},{"type":"codeVoice","code":"KoinDI.kt"},{"text":"):","type":"text"}]}]},{"code":["fun initKoin() {","    startKoin {","        modules(","            platformDependency,    \/\/ HttpClient, Firebase","            apiDependency,         \/\/ 33 API services","            repoDependency,        \/\/ 34 Repositories","            viewmodelDependency    \/\/ 37 ViewModels","        )","    }","}","","val apiDependency = module {","    single { ProductsApi(get()) }","    single { CustomerApi(get()) }","    single { DashboardApi(get()) }","    \/\/ ... 30 more","}","","val repoDependency = module {","    single<ProductsRepository> { ProductsRepositoryImpl(get()) }","    single<CustomerRepository> { CustomerRepositoryImpl(get()) }","    \/\/ ... 32 more","}","","val viewmodelDependency = module {","    single { ProductsViewmodel() }","    single { CustomersViewModel() }","    \/\/ ... 35 more","}"],"type":"codeListing","syntax":"kotlin"},{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"text":"iOS Integration:","type":"text"}]}]},{"code":["\/\/ Initialize Koin from iOS","func application(...) -> Bool {","    KoinDIKt.doInitKoin()","    return true","}","","\/\/ Access ViewModels","@StateViewModel var productsVM = DIHelper().productsViewmodel"],"type":"codeListing","syntax":"swift"},{"type":"thematicBreak"},{"level":2,"anchor":"iOS-Architecture","type":"heading","text":"iOS Architecture"},{"level":3,"anchor":"Layer-Breakdown","type":"heading","text":"Layer Breakdown"},{"level":4,"anchor":"1-Presentation-Layer-Presentation","type":"heading","text":"1. Presentation Layer (`\/Presentation\/`)"},{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"text":"Structure:","type":"text"}]}]},{"code":["Presentation\/","├── Splash\/                    # App launch & auth check","├── Account\/                   # Authentication flow","│   ├── PhoneNumberView","│   ├── OTPView","│   └── WelcomeView","├── Navigation\/               # Navigation system","│   ├── Navigator.swift       # Navigation manager","│   ├── NavigationCoordinator.swift","│   └── DeeplinkNavigation.swift","├── Home\/                     # Main application","│   ├── Dashboard\/           # Landing screen","│   ├── Bills\/               # Invoices, Purchases","│   │   ├── CreateBill\/","│   │   ├── DocumentDetails\/","│   │   └── EWayBills\/","│   ├── Products\/            # Product catalog","│   ├── Parties\/             # Customers, Vendors","│   │   ├── Customers\/","│   │   ├── Vendors\/","│   │   └── Ledger\/","│   └── More\/                # Settings","│       ├── CompanyDetails\/","│       ├── InvoiceSettings\/","│       └── Profile\/","├── CustomViews\/             # 68+ reusable components","│   ├── SwipeSheet\/","│   ├── SwipeCard\/","│   ├── ResourceStateHandler\/","│   ├── RichTextEditor\/","│   └── ...","├── Theme\/                   # Design system","│   └── Color.swift","├── IAP\/                     # In-App Purchases","│   └── StoreKitService.swift","└── Reports\/                 # Native reports","    └── SpreadsheetView\/"],"type":"codeListing","syntax":null},{"level":4,"anchor":"2-Navigation-System","type":"heading","text":"2. Navigation System"},{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"text":"Custom Navigation Manager (","type":"text"},{"type":"codeVoice","code":"Navigator.swift"},{"text":"):","type":"text"}]}]},{"code":["class Navigator: ObservableObject {","    @Published var navigationPath = NavigationPath()","    @Published var stack: Stack<Destination> = []","    @Published var shouldShowSheet = false","    @Published var sheetNavigationPath = NavigationPath()","","    enum Destination {","        case Sales","        case Purchases","        case ProductDetailScreen(productId: String)","        case CreateBill(documentType: DocumentTypes, isEdit: Bool)","        case AddCustomerView(isComingFromCreateBillScreen: Bool)","        \/\/ 50+ destination types","    }","","    func navigate(to destination: Destination) {","        stack.push(destination)","        navigationPath.append(destination)","    }","","    func navigateBack() {","        _ = stack.pop()","        if !navigationPath.isEmpty {","            navigationPath.removeLast()","        }","    }","","    func navigateBackTo(k: Int) {","        for _ in 0..<k {","            navigateBack()","        }","    }","","    func popToRoot() {","        stack.removeAll()","        navigationPath = NavigationPath()","    }","","    func navigateSheet(to destination: Destination) {","        shouldShowSheet = true","        sheetNavigationPath.append(destination)","    }","}"],"type":"codeListing","syntax":"swift"},{"type":"paragraph","inlineContent":[{"inlineContent":[{"type":"text","text":"Features:"}],"type":"strong"}]},{"items":[{"content":[{"inlineContent":[{"text":"Type-safe navigation with enum destinations","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"Custom back stack management","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Sheet (modal) navigation support"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Deep linking integration"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Preservation of navigation state"}],"type":"paragraph"}]}],"type":"unorderedList"},{"text":"3. Data Persistence","anchor":"3-Data-Persistence","level":4,"type":"heading"},{"type":"paragraph","inlineContent":[{"inlineContent":[{"type":"text","text":"A. RealmSwift (Primary Database)"}],"type":"strong"}]},{"inlineContent":[{"text":"Location: ","type":"text"},{"code":"\/Presentation\/CustomViews\/Realm\/","type":"codeVoice"}],"type":"paragraph"},{"inlineContent":[{"inlineContent":[{"text":"Realm Models:","type":"text"}],"type":"strong"}],"type":"paragraph"},{"code":["class NotesAndTermsDataModalRealm: Object {","    @Persisted(primaryKey: true) var id: String","    @Persisted var notes: String","    @Persisted var terms: String","}","","class CompanyBankDetailsRealm: Object {","    @Persisted(primaryKey: true) var id: String","    @Persisted var bankName: String","    @Persisted var accountNumber: String","    @Persisted var ifscCode: String","}","","\/\/ 20+ Realm models"],"type":"codeListing","syntax":"swift"},{"inlineContent":[{"type":"strong","inlineContent":[{"text":"RealmUtils:","type":"text"}]}],"type":"paragraph"},{"syntax":"swift","code":["extension RealmUtils {","    func saveNotesAndTerms(data: CompanyDetailsResponse) {","        let realm = try! Realm()","        let realmModel = NotesAndTermsDataModalRealm()","        \/\/ Convert KMM model to Realm model","        try! realm.write {","            realm.add(realmModel, update: .modified)","        }","    }","","    func getNotesAndTerms() -> NotesAndTermsDataModalRealm? {","        let realm = try! Realm()","        return realm.objects(NotesAndTermsDataModalRealm.self).first","    }","}"],"type":"codeListing"},{"inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"B. SharedPreferences (UserDefaults)"}]}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"Location: "},{"type":"codeVoice","code":"\/Common\/SharedPrefs.swift"}],"type":"paragraph"},{"inlineContent":[{"type":"strong","inlineContent":[{"text":"Usage:","type":"text"}]}],"type":"paragraph"},{"type":"codeListing","syntax":"swift","code":["class SharedPrefs {","    static let shared = SharedPrefs()","","    var authToken: String? {","        get { UserDefaults.standard.string(forKey: \"auth_token\") }","        set { UserDefaults.standard.set(newValue, forKey: \"auth_token\") }","    }","","    var companyId: String? {","        get { UserDefaults.standard.string(forKey: \"company_id\") }","        set { UserDefaults.standard.set(newValue, forKey: \"company_id\") }","    }","","    \/\/ Widget data sharing via App Groups","    func saveWidgetData(_ data: WidgetData) {","        let defaults = UserDefaults(suiteName: \"group.getswipe.in\")","        defaults?.set(data.encoded, forKey: \"widget_data\")","    }","}"]},{"inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"C. Keychain (Secure Storage)"}]}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"text":"Location: ","type":"text"},{"type":"codeVoice","code":"\/Security\/KeychainManager.swift"}]},{"inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Implementation:"}]}],"type":"paragraph"},{"type":"codeListing","syntax":"swift","code":["protocol KeychainManagerProtocol {","    func saveToken(_ token: String) -> Result<Void, KeychainError>","    func getToken() -> Result<String?, KeychainError>","    func deleteToken() -> Result<Void, KeychainError>","}","","final class KeychainManager: KeychainManagerProtocol {","    static let shared = KeychainManager()","    private let service = \"com.swipe.mac\"","    private let account = \"auth_token\"","","    func saveToken(_ token: String) -> Result<Void, KeychainError> {","        let data = Data(token.utf8)","        let query: [String: Any] = [","            kSecClass as String: kSecClassGenericPassword,","            kSecAttrService as String: service,","            kSecAttrAccount as String: account,","            kSecValueData as String: data,","            kSecAttrAccessible as String: kSecAttrAccessibleWhenUnlockedThisDeviceOnly","        ]","","        let status = SecItemAdd(query as CFDictionary, nil)","        return status == errSecSuccess ? .success(()) : .failure(.saveFailed(status))","    }","}"]},{"text":"4. Networking","type":"heading","anchor":"4-Networking","level":4},{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"text":"A. NetworkManager (iOS-specific)","type":"text"}]}]},{"inlineContent":[{"text":"Location: ","type":"text"},{"type":"codeVoice","code":"\/System\/NetworkManager.swift"}],"type":"paragraph"},{"type":"codeListing","syntax":"swift","code":["class NetworkManager {","    static let shared = NetworkManager()","    private let baseURL = \"https:\/\/app.getswipe.in\/api\/\"","","    func request<T: Decodable>(","        endpoint: String,","        method: HTTPMethod,","        queryParams: [String: String]? = nil,","        requestBody: Encodable? = nil,","        completion: @escaping (Result<T, Error>) -> Void","    ) {","        var components = URLComponents(string: baseURL + endpoint)","        components?.queryItems = queryParams?.map { URLQueryItem(name: $0.key, value: $0.value) }","","        guard let url = components?.url else {","            completion(.failure(NetworkError.invalidURL))","            return","        }","","        var request = URLRequest(url: url)","        request.httpMethod = method.rawValue","        request.setValue(\"Bearer \\(authToken)\", forHTTPHeaderField: \"Authorization\")","        request.setValue(\"application\/json\", forHTTPHeaderField: \"Content-Type\")","        request.setValue(deviceFingerprint, forHTTPHeaderField: \"Device_Fingerprint\")","","        if let body = requestBody {","            request.httpBody = try? JSONEncoder().encode(body)","        }","","        URLSession.shared.dataTask(with: request) { data, response, error in","            \/\/ Handle response","        }.resume()","    }","}"]},{"inlineContent":[{"type":"strong","inlineContent":[{"text":"B. Network Monitoring","type":"text"}]}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"Location: "},{"code":"\/Network\/NetworkMonitor.swift","type":"codeVoice"}],"type":"paragraph"},{"syntax":"swift","code":["class NetworkMonitor: ObservableObject {","    @Published var isConnected = true","    private let monitor = NWPathMonitor()","","    init() {","        monitor.pathUpdateHandler = { [weak self] path in","            DispatchQueue.main.async {","                self?.isConnected = path.status == .satisfied","            }","        }","        monitor.start(queue: DispatchQueue.global(qos: .background))","    }","}"],"type":"codeListing"},{"text":"5. In-App Purchases","type":"heading","anchor":"5-In-App-Purchases","level":4},{"inlineContent":[{"type":"text","text":"Location: "},{"code":"\/Presentation\/IAP\/StoreKitService.swift","type":"codeVoice"}],"type":"paragraph"},{"syntax":"swift","code":["@MainActor","final class StoreKitService: ObservableObject {","    @Published var products: [StoreKit.Product] = []","    @Published var isPurchasing: Bool = false","    @Published var activeSubscription: StoreKit.Product?","","    private let productIDs = [","        \"com.swipe.premium.monthly\",","        \"com.swipe.premium.yearly\"","    ]","","    func loadProducts() async {","        do {","            products = try await Product.products(for: productIDs)","        } catch {","            print(\"Failed to load products: \\(error)\")","        }","    }","","    func purchase(product: Product, companyId: Int32) async {","        isPurchasing = true","        defer { isPurchasing = false }","","        do {","            let result = try await product.purchase()","","            switch result {","            case .success(let verification):","                switch verification {","                case .verified(let transaction):","                    \/\/ Validate with backend","                    await validatePurchase(transaction, companyId: companyId)","                    await transaction.finish()","                case .unverified:","                    break","                }","            case .userCancelled:","                break","            case .pending:","                break","            @unknown default:","                break","            }","        } catch {","            print(\"Purchase failed: \\(error)\")","        }","    }","","    private func listenForTransactions() -> Task<Void, Error> {","        return Task.detached {","            for await result in Transaction.updates {","                \/\/ Handle transaction updates","            }","        }","    }","}"],"type":"codeListing"},{"type":"heading","level":4,"text":"6. Analytics","anchor":"6-Analytics"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Location: "},{"code":"\/Analytics\/AnalyticsManager.swift","type":"codeVoice"}]},{"type":"codeListing","code":["protocol AnalyticsLogging {","    func log(_ event: AnalyticsEvent)","    func setUserProperty(_ value: String?, for: UserProperty)","    func setUserID(_ id: String?)","}","","enum AnalyticsEvent {","    case screenView(name: String, screenClass: String)","    case login(method: LoginMethod, otpToLoginTime: TimeInterval?)","    case onboardingComplete(withGST: Bool, timeTaken: TimeInterval?)","    case firstInvoiceCreated(documentType: String, timeTaken: TimeInterval?)","    case documentCreated(type: String)","    case subscriptionPurchased(plan: String, price: Decimal)","    case featureUsed(feature: String)","","    var parameters: [String: Any] {","        switch self {","        case .screenView(let name, let screenClass):","            return [\"screen_name\": name, \"screen_class\": screenClass]","        case .login(let method, let time):","            var params: [String: Any] = [\"method\": method.rawValue]","            if let time = time {","                params[\"otp_to_login_time\"] = time","            }","            return params","        \/\/ ... other cases","        }","    }","}","","class AnalyticsManager: AnalyticsLogging {","    static let shared = AnalyticsManager()","","    private let firebaseAnalytics = FirebaseAnalytics.Analytics.self","    private let clarityAnalytics = Clarity.self","","    func log(_ event: AnalyticsEvent) {","        firebaseAnalytics.logEvent(event.name, parameters: event.parameters)","        clarityAnalytics.logCustomEvent(event.name, withProperties: event.parameters)","    }","","    func setUserProperty(_ value: String?, for property: UserProperty) {","        firebaseAnalytics.setUserProperty(value, forName: property.rawValue)","    }","","    func setUserID(_ id: String?) {","        firebaseAnalytics.setUserID(id)","        if let id = id {","            clarityAnalytics.setCustomUserId(id)","        }","    }","}"],"syntax":"swift"},{"type":"paragraph","inlineContent":[{"inlineContent":[{"type":"text","text":"Usage:"}],"type":"strong"}]},{"type":"codeListing","syntax":"swift","code":["AnalyticsManager.shared.log(.screenView(name: \"Dashboard\", screenClass: \"DashboardView\"))","AnalyticsManager.shared.log(.documentCreated(type: \"INVOICE\"))"]},{"text":"7. Custom UI Components","anchor":"7-Custom-UI-Components","level":4,"type":"heading"},{"type":"paragraph","inlineContent":[{"type":"text","text":"68+ reusable components in "},{"code":"\/Presentation\/CustomViews\/","type":"codeVoice"},{"text":":","type":"text"}]},{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Notable Components:"}]}]},{"type":"orderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"inlineContent":[{"type":"text","text":"SwipeSheet"}],"type":"strong"},{"type":"text","text":" - Custom bottom sheet"}]}]}]},{"syntax":"swift","code":["struct SwipeSheet<Content: View>: View {","    @Binding var isPresented: Bool","    let content: Content","","    var body: some View {","        ZStack(alignment: .bottom) {","            if isPresented {","                Color.black.opacity(0.4)","                    .ignoresSafeArea()","                    .onTapGesture { isPresented = false }","","                content","                    .transition(.move(edge: .bottom))","            }","        }","    }","}"],"type":"codeListing"},{"type":"orderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"ResourceStateHandler"}]},{"type":"text","text":" - Generic state view"}]}]}],"start":2},{"type":"codeListing","syntax":"swift","code":["struct ResourceStateHandler<T, Content: View>: View {","    let resourceState: ResourceState<T, Exception>","    let onLoadedData: (T) -> Content","","    var body: some View {","        switch resourceState {","        case is ResourceStateLoading:","            LoadingView()","        case let state as ResourceStateSuccess<T, Exception>:","            onLoadedData(state.data)","        case let state as ResourceStateFailed<T, Exception>:","            ErrorView(error: state.error)","        case is ResourceStateEmpty:","            EmptyStateView()","        default:","            EmptyView()","        }","    }","}"]},{"start":3,"type":"orderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"inlineContent":[{"type":"text","text":"SwipeEditText"}],"type":"strong"},{"type":"text","text":" - Custom text field"}]}]}]},{"type":"codeListing","syntax":"swift","code":["struct SwipeEditText: View {","    @Binding var text: String","    let placeholder: String","    let keyboardType: UIKeyboardType","    let isSecure: Bool","","    var body: some View {","        if isSecure {","            SecureField(placeholder, text: $text)","        } else {","            TextField(placeholder, text: $text)","                .keyboardType(keyboardType)","        }","        .padding()","        .background(Color.textFieldBackground)","        .cornerRadius(8)","    }","}"]},{"type":"thematicBreak"},{"text":"KMM Architecture","anchor":"KMM-Architecture","level":2,"type":"heading"},{"type":"heading","level":3,"text":"Layer Breakdown","anchor":"Layer-Breakdown"},{"text":"1. Domain Layer (`domain\/model\/`)","anchor":"1-Domain-Layer-domainmodel","level":4,"type":"heading"},{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Repository Interfaces:"}]}]},{"type":"codeListing","syntax":"kotlin","code":["\/\/ domain\/model\/repository\/ProductsRepository.kt","interface ProductsRepository {","    suspend fun getProducts(request: GetProductsRequest): ResourceState<ProductsResponse, Exception>","    suspend fun createProduct(request: CreateProductRequest): ResourceState<CreateProductResponse, Exception>","    suspend fun updateProduct(request: UpdateProductRequest): ResourceState<UpdateProductResponse, Exception>","    suspend fun deleteProduct(request: DeleteProductRequest): ResourceState<DeleteProductResponse, Exception>","}"]},{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Data Models:"}]}]},{"type":"codeListing","syntax":"kotlin","code":["\/\/ domain\/model\/data\/Product.kt","@Serializable","data class Product(","    @SerialName(\"id\") val id: Int,","    @SerialName(\"name\") val name: String,","    @SerialName(\"sale_price\") val salePrice: Double,","    @SerialName(\"purchase_price\") val purchasePrice: Double?,","    @SerialName(\"stock_quantity\") val stockQuantity: Int?,","    @SerialName(\"description\") val description: String?,","    @SerialName(\"hsn_code\") val hsnCode: String?,","    @SerialName(\"tax_rate\") val taxRate: Double?,","    @SerialName(\"unit\") val unit: String?,","    @SerialName(\"category\") val category: ProductCategory?",")"]},{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"text":"Request\/Response Models:","type":"text"}]}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"173 request models in ","type":"text"},{"type":"codeVoice","code":"domain\/model\/requests\/"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"165 response models in "},{"type":"codeVoice","code":"domain\/model\/responses\/"}]}]}]},{"text":"2. Data Layer (`data\/`)","anchor":"2-Data-Layer-data","level":4,"type":"heading"},{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"text":"Repository Implementations:","type":"text"}]}]},{"type":"codeListing","syntax":"kotlin","code":["\/\/ data\/repository\/ProductsRepositoryImpl.kt","class ProductsRepositoryImpl(","    private val productsApi: ProductsApi",") : ProductsRepository {","","    override suspend fun getProducts(request: GetProductsRequest): ResourceState<ProductsResponse, Exception> {","        return try {","            val response = productsApi.getProducts(request)","            NetworkUtils.handleResponse(response)","        } catch (e: JsonConvertException) {","            FirebaseCrashlytics.recordException(e)","            ResourceState.failed(Exception(\"Invalid response format\"))","        } catch (e: Exception) {","            FirebaseCrashlytics.recordException(e)","            ResourceState.failed(e)","        }","    }","","    override suspend fun createProduct(request: CreateProductRequest): ResourceState<CreateProductResponse, Exception> {","        return try {","            val response = productsApi.createProduct(request)","            NetworkUtils.handleResponse(response)","        } catch (e: Exception) {","            ResourceState.failed(e)","        }","    }","}"]},{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"API Services:"}]}]},{"type":"codeListing","code":["\/\/ data\/remote\/ProductsApi.kt","class ProductsApi(private val httpClient: HttpClient) {","","    suspend fun getProducts(request: GetProductsRequest): HttpResponse {","        return httpClient.post {","            url(Constants.Endpoints.GET_PRODUCTS)","            setBody(request)","        }","    }","","    suspend fun createProduct(request: CreateProductRequest): HttpResponse {","        return httpClient.post {","            url(Constants.Endpoints.CREATE_PRODUCT)","            setBody(request)","        }","    }","","    suspend fun updateProduct(request: UpdateProductRequest): HttpResponse {","        return httpClient.post {","            url(Constants.Endpoints.UPDATE_PRODUCT)","            setBody(request)","        }","    }","","    suspend fun deleteProduct(request: DeleteProductRequest): HttpResponse {","        return httpClient.post {","            url(Constants.Endpoints.DELETE_PRODUCT)","            setBody(request)","        }","    }","}"],"syntax":"kotlin"},{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"ViewModels:"}]}]},{"type":"codeListing","code":["\/\/ data\/viewmodel\/ProductsViewmodel.kt","class ProductsViewmodel : ViewModel() {","","    private val productsRepository: ProductsRepository by inject()","","    val products = MutableLiveData<ResourceState<ProductsResponse, Exception>>(ResourceState.loading())","    val createProductResponse = MutableLiveData<ResourceState<CreateProductResponse, Exception>>(ResourceState.empty())","","    fun onUIEvent(events: ProductsUIEvents) {","        when (events) {","            is ProductsUIEvents.FetchProducts -> fetchProducts(events.request)","            is ProductsUIEvents.CreateProduct -> createProduct(events.request)","            is ProductsUIEvents.UpdateProduct -> updateProduct(events.request)","            is ProductsUIEvents.DeleteProduct -> deleteProduct(events.request)","            is ProductsUIEvents.SearchProducts -> searchProducts(events.query)","        }","    }","","    private fun fetchProducts(request: GetProductsRequest) {","        viewModelScope.launch {","            products.postValue(ResourceState.loading())","            val result = productsRepository.getProducts(request)","            products.postValue(result)","        }","    }","","    private fun createProduct(request: CreateProductRequest) {","        viewModelScope.launch {","            createProductResponse.postValue(ResourceState.loading())","            val result = productsRepository.createProduct(request)","            createProductResponse.postValue(result)","        }","    }","}"],"syntax":"kotlin"},{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"UI Events:"}]}]},{"type":"codeListing","code":["\/\/ data\/events\/ProductsUIEvents.kt","sealed class ProductsUIEvents {","    data class FetchProducts(val request: GetProductsRequest) : ProductsUIEvents()","    data class CreateProduct(val request: CreateProductRequest) : ProductsUIEvents()","    data class UpdateProduct(val request: UpdateProductRequest) : ProductsUIEvents()","    data class DeleteProduct(val request: DeleteProductRequest) : ProductsUIEvents()","    data class SearchProducts(val query: String) : ProductsUIEvents()","}"],"syntax":"kotlin"},{"text":"3. Network Layer","anchor":"3-Network-Layer","level":4,"type":"heading"},{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Ktor HttpClient Configuration:"}]}]},{"type":"codeListing","code":["\/\/ di\/KoinDI.kt","val platformDependency = module {","    single {","        httpClient {","            install(ContentNegotiation) {","                json(Json {","                    prettyPrint = true","                    isLenient = true","                    ignoreUnknownKeys = true","                    encodeDefaults = true","                    explicitNulls = false","                    coerceInputValues = true","                    useAlternativeNames = true","                })","            }","","            install(Logging) {","                logger = Logger.DEFAULT","                level = LogLevel.ALL","            }","","            install(HttpTimeout) {","                requestTimeoutMillis = 60000","                connectTimeoutMillis = 60000","                socketTimeoutMillis = 60000","            }","","            defaultRequest {","                val token = SharedPreferences.getAuthToken()","                if (token != null) {","                    header(\"Authorization\", \"Bearer $token\")","                }","                header(\"Device_Fingerprint\", Utils.getDeviceId())","                header(\"User-Agent\", Utils.getUserAgent())","                header(\"Request-Timestamp\", Utils.getCurrentDateTime())","                header(\"X-Request-ID\", Utils.getPlatformUniqueId())","                header(\"source\", \"ios_${Constants.APP_VERSION}\")","            }","        }","    }","}"],"syntax":"kotlin"},{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Network Response Handling:"}]}]},{"type":"codeListing","code":["\/\/ data\/network\/NetworkUtils.kt","object NetworkUtils {","    suspend inline fun <reified T> handleResponse(response: HttpResponse): ResourceState<T, Exception> {","        return when (response.status.value) {","            in 200..299 -> {","                try {","                    val data = response.body<T>()","                    ResourceState.success(data)","                } catch (e: JsonConvertException) {","                    FirebaseCrashlytics.recordException(e)","                    ResourceState.failed(Exception(\"Failed to parse response\"))","                }","            }","            401 -> {","                \/\/ Unauthorized - logout user","                SharedPreferences.clearAuthToken()","                ResourceState.failed(Exception(\"Session expired\"))","            }","            429 -> {","                \/\/ Too many requests","                ResourceState.failed(Exception(\"Too many requests, please try again\"))","            }","            in 500..511 -> {","                \/\/ Server error","                SharedPreferences.setServerDown(true)","                ResourceState.failed(Exception(\"Server is down\"))","            }","            else -> {","                val errorBody = response.bodyAsText()","                val error = parseError(errorBody)","                ResourceState.failed(Exception(error.message))","            }","        }","    }","","    private fun parseError(errorBody: String): SwipeError {","        return try {","            Json.decodeFromString<SwipeError>(errorBody)","        } catch (e: Exception) {","            SwipeError(message = \"An error occurred\")","        }","    }","}"],"syntax":"kotlin"},{"text":"4. Platform-Specific Code (expect\/actual)","anchor":"4-Platform-Specific-Code-expectactual","level":4,"type":"heading"},{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Example: Utils.kt"}]}]},{"type":"codeListing","code":["\/\/ commonMain\/common\/Utils.kt","expect object Utils {","    fun getDeviceId(): String","    fun getCurrentDateTime(): String","    fun getUserAgent(): String","    fun getPlatformUniqueId(): String","}","","\/\/ iosMain\/common\/Utils.kt","actual object Utils {","    actual fun getDeviceId(): String {","        return UIDevice.currentDevice.identifierForVendor?.UUIDString ?: \"\"","    }","","    actual fun getCurrentDateTime(): String {","        val formatter = NSDateFormatter()","        formatter.dateFormat = \"yyyy-MM-dd HH:mm:ss\"","        return formatter.stringFromDate(NSDate())","    }","","    actual fun getUserAgent(): String {","        val device = UIDevice.currentDevice","        return \"Swipe iOS\/${Constants.APP_VERSION} (${device.model}; iOS ${device.systemVersion})\"","    }","","    actual fun getPlatformUniqueId(): String {","        return NSUUID().UUIDString","    }","}","","\/\/ androidMain\/common\/Utils.kt","actual object Utils {","    actual fun getDeviceId(): String {","        return Settings.Secure.getString(context.contentResolver, Settings.Secure.ANDROID_ID)","    }","","    actual fun getCurrentDateTime(): String {","        return SimpleDateFormat(\"yyyy-MM-dd HH:mm:ss\", Locale.getDefault()).format(Date())","    }","","    actual fun getUserAgent(): String {","        return \"Swipe Android\/${Constants.APP_VERSION} (${Build.MODEL}; Android ${Build.VERSION.RELEASE})\"","    }","","    actual fun getPlatformUniqueId(): String {","        return UUID.randomUUID().toString()","    }","}"],"syntax":"kotlin"},{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Other expect\/actual Declarations:"}]}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"HttpClient.kt"},{"text":" - Platform-specific HTTP engines","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"File.kt"},{"text":" - File handling (UIImage vs ContentResolver)","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"Firebase.kt"},{"text":" - Firebase initialization","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"Log.kt"},{"text":" - Logging implementation","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"DateUtils.kt"},{"text":" - Date parsing","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"TimestampUtils.kt"},{"text":" - Timestamp conversion","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"SharedPreferences.kt"},{"text":" - Platform storage","type":"text"}]}]}]},{"text":"5. State Management","anchor":"5-State-Management","level":4,"type":"heading"},{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"MOKO MVVM Integration:"}]}]},{"type":"codeListing","code":["\/\/ ViewModels extend MOKO's ViewModel","abstract class ViewModel : dev.icerock.moko.mvvm.viewmodel.ViewModel()","","\/\/ LiveData for reactive state","class DashboardViewModel : ViewModel() {","    val companyDetails = MutableLiveData<ResourceState<CompanyResponse, Exception>>(ResourceState.loading())","    val dashboardStats = MutableLiveData<ResourceState<DashboardStatsResponse, Exception>>(ResourceState.empty())","}"],"syntax":"kotlin"},{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"iOS Observation:"}]}]},{"type":"codeListing","code":["class DashboardVM: shared.DashboardViewModel {","    @Published var isLoading = false","","    private var companyObserver: Observer<ResourceState<CompanyResponse, KotlinException>>?","","    override init() {","        super.init()","        initObservers()","    }","","    func initObservers() {","        companyObserver = Observer { [weak self] state in","            DispatchQueue.main.async {","                self?.isLoading = state is ResourceStateLoading","            }","        }","        self.companyDetails.addObserver(observer: companyObserver!)","    }","","    deinit {","        self.companyDetails.removeObserver(observer: companyObserver!)","    }","}"],"syntax":"swift"},{"type":"thematicBreak"},{"text":"Data Flow","anchor":"Data-Flow","level":2,"type":"heading"},{"text":"End-to-End Request Flow","anchor":"End-to-End-Request-Flow","level":3,"type":"heading"},{"type":"codeListing","code":["┌─────────────────────────────────────────────────────────────────┐","│                         User Action                             │","│                   (Button tap in SwiftUI)                       │","└───────────────────────────┬─────────────────────────────────────┘","                            │","┌───────────────────────────▼─────────────────────────────────────┐","│                      SwiftUI View                               │","│   productsViewmodel.onUIEvent(events: FetchProducts())          │","└───────────────────────────┬─────────────────────────────────────┘","                            │","┌───────────────────────────▼─────────────────────────────────────┐","│              Swift ViewModel (iOS Extension)                    │","│    Forwards event to KMM ViewModel, manages iOS-specific state  │","└───────────────────────────┬─────────────────────────────────────┘","                            │","┌───────────────────────────▼─────────────────────────────────────┐","│                  KMM ViewModel (Kotlin)                         │","│    fun onUIEvent(events: ProductsUIEvents) {                    │","│        when(events) {                                           │","│            is FetchProducts -> fetchProducts()                  │","│        }                                                        │","│    }                                                            │","│    products.postValue(ResourceState.loading())                  │","└───────────────────────────┬─────────────────────────────────────┘","                            │","┌───────────────────────────▼─────────────────────────────────────┐","│                  Repository Interface (Domain)                  │","│    interface ProductsRepository {                               │","│        suspend fun getProducts(...): ResourceState<...>         │","│    }                                                            │","└───────────────────────────┬─────────────────────────────────────┘","                            │","┌───────────────────────────▼─────────────────────────────────────┐","│              Repository Implementation (Data)                   │","│    class ProductsRepositoryImpl(                                │","│        private val productsApi: ProductsApi                     │","│    ) : ProductsRepository {                                     │","│        override suspend fun getProducts(...) {                  │","│            val response = productsApi.getProducts(request)      │","│            return NetworkUtils.handleResponse(response)         │","│        }                                                        │","│    }                                                            │","└───────────────────────────┬─────────────────────────────────────┘","                            │","┌───────────────────────────▼─────────────────────────────────────┐","│                   API Service (Ktor)                            │","│    class ProductsApi(private val httpClient: HttpClient) {      │","│        suspend fun getProducts(request: GetProductsRequest) {   │","│            return httpClient.post {                             │","│                url(Constants.Endpoints.GET_PRODUCTS)            │","│                setBody(request)                                 │","│            }                                                    │","│        }                                                        │","│    }                                                            │","└───────────────────────────┬─────────────────────────────────────┘","                            │","┌───────────────────────────▼─────────────────────────────────────┐","│                  Ktor HttpClient                                │","│    - Adds Authorization header                                  │","│    - Adds Device_Fingerprint                                    │","│    - Adds User-Agent                                            │","│    - Serializes request body to JSON                            │","└───────────────────────────┬─────────────────────────────────────┘","                            │","                            ▼","                    ┌───────────────┐","                    │  Backend API  │","                    └───────┬───────┘","                            │","┌───────────────────────────▼─────────────────────────────────────┐","│                  Response Handling                              │","│    - Deserializes JSON to Kotlin data class                     │","│    - Checks HTTP status code                                    │","│    - Wraps in ResourceState                                     │","└───────────────────────────┬─────────────────────────────────────┘","                            │","┌───────────────────────────▼─────────────────────────────────────┐","│              Repository Returns Result                          │","│    ResourceState.success(ProductsResponse)                      │","└───────────────────────────┬─────────────────────────────────────┘","                            │","┌───────────────────────────▼─────────────────────────────────────┐","│          ViewModel Updates LiveData                             │","│    products.postValue(ResourceState.success(data))              │","└───────────────────────────┬─────────────────────────────────────┘","                            │","┌───────────────────────────▼─────────────────────────────────────┐","│        Swift ViewModel Observer Triggered                       │","│    Observer receives new state, updates @Published properties   │","└───────────────────────────┬─────────────────────────────────────┘","                            │","┌───────────────────────────▼─────────────────────────────────────┐","│              SwiftUI View Updates                               │","│    ResourceStateHandler detects state change, re-renders UI     │","└─────────────────────────────────────────────────────────────────┘"],"syntax":null},{"text":"Offline Data Flow","anchor":"Offline-Data-Flow","level":3,"type":"heading"},{"type":"codeListing","code":["┌─────────────────────────────────────────────────────────────────┐","│                      App Launch                                 │","└───────────────────────────┬─────────────────────────────────────┘","                            │","┌───────────────────────────▼─────────────────────────────────────┐","│              Load Cached Data from Realm                        │","│    RealmUtils.getCompanyDetails()                               │","│    RealmUtils.getProducts()                                     │","└───────────────────────────┬─────────────────────────────────────┘","                            │","┌───────────────────────────▼─────────────────────────────────────┐","│              Display Cached Data to User                        │","│    (Immediate UI response)                                      │","└───────────────────────────┬─────────────────────────────────────┘","                            │","┌───────────────────────────▼─────────────────────────────────────┐","│         Check Network Connectivity                              │","│    NetworkMonitor.isConnected                                   │","└───────────────┬───────────────────────┬─────────────────────────┘","                │                       │","    ┌───────────▼──────────┐   ┌────────▼────────────┐","    │   No Connection      │   │   Connected         │","    │   Show cached data   │   │   Fetch fresh data  │","    └──────────────────────┘   └────────┬────────────┘","                                        │","                          ┌─────────────▼──────────────┐","                          │   API Call Success         │","                          │   Save to Realm            │","                          │   Update UI                │","                          └────────────────────────────┘"],"syntax":null},{"type":"thematicBreak"},{"text":"Module Dependencies","anchor":"Module-Dependencies","level":2,"type":"heading"},{"text":"Dependency Graph","anchor":"Dependency-Graph","level":3,"type":"heading"},{"type":"codeListing","code":["┌──────────────────────────────────────────────────────────────────┐","│                          iOS App                                 │","│                      (SwiftUI Views)                             │","└────────────────────┬────────────────────┬────────────────────────┘","                     │                    │","        ┌────────────▼──────────┐  ┌──────▼────────────┐","        │ iOS ViewModels        │  │ Custom UI         │","        │ (Swift Extensions)    │  │ Components        │","        └────────────┬──────────┘  └───────────────────┘","                     │","        ┌────────────▼──────────────────────────┐","        │      KMM ViewModels (Kotlin)          │","        │   - 37 ViewModels                     │","        │   - MOKO MVVM                         │","        └────────────┬──────────────────────────┘","                     │","        ┌────────────▼──────────────────────────┐","        │   Repository Interfaces (Domain)      │","        │   - 34 Repository Interfaces          │","        └────────────┬──────────────────────────┘","                     │","        ┌────────────▼──────────────────────────┐","        │  Repository Implementations (Data)    │","        │   - 34 Repository Implementations     │","        └────────────┬──────────────────────────┘","                     │","        ┌────────────▼──────────────────────────┐","        │      API Services (Ktor)              │","        │   - 33 API Service Classes            │","        └────────────┬──────────────────────────┘","                     │","        ┌────────────▼──────────────────────────┐","        │         HttpClient                    │","        │   - Ktor Engine (Darwin\/OkHttp)       │","        │   - JSON Serialization                │","        │   - Request\/Response Interceptors     │","        └────────────┬──────────────────────────┘","                     │","                     ▼","              Backend REST API"],"syntax":null},{"text":"iOS-Specific Dependencies","anchor":"iOS-Specific-Dependencies","level":3,"type":"heading"},{"type":"codeListing","code":["┌─────────────────────────────────────────────────────────┐","│                    iOS Application                      │","└─────────┬───────────────────────────┬───────────────────┘","          │                           │","┌─────────▼──────────┐      ┌─────────▼──────────┐","│ RealmSwift         │      │ KeychainManager    │","│ (Local DB)         │      │ (Secure Storage)   │","└────────────────────┘      └────────────────────┘","          │","┌─────────▼──────────┐","│ NetworkManager     │","│ (iOS Networking)   │","└────────────────────┘","          │","┌─────────▼──────────┐","│ StoreKitService    │","│ (IAP)              │","└────────────────────┘","          │","┌─────────▼──────────┐","│ AnalyticsManager   │","│ (Firebase+Clarity) │","└────────────────────┘"],"syntax":null},{"text":"KMM Module Dependencies","anchor":"KMM-Module-Dependencies","level":3,"type":"heading"},{"type":"codeListing","code":["┌─────────────────────────────────────────────────────────┐","│                  KMM Shared Module                      │","└─────────┬───────────────────────────┬───────────────────┘","          │                           │","┌─────────▼──────────┐      ┌─────────▼──────────┐","│ Koin               │      │ Ktor Client        │","│ (DI)               │      │ (Networking)       │","└────────────────────┘      └────────────────────┘","          │","┌─────────▼──────────┐","│ kotlinx.           │","│ serialization      │","│ (JSON)             │","└────────────────────┘","          │","┌─────────▼──────────┐","│ MOKO MVVM          │","│ (ViewModel+LiveData│","└────────────────────┘","          │","┌─────────▼──────────┐","│ multiplatform-     │","│ settings           │","│ (SharedPreferences)│","└────────────────────┘"],"syntax":null},{"text":"Dependency Injection Flow","anchor":"Dependency-Injection-Flow","level":3,"type":"heading"},{"type":"codeListing","code":["┌─────────────────────────────────────────────────────────┐","│                    KoinDI.kt                            │","│                  initKoin()                             │","└─────────┬───────────────────────────┬───────────────────┘","          │                           │","┌─────────▼──────────┐      ┌─────────▼──────────┐","│ platformDependency │      │ apiDependency      │","│ - HttpClient       │      │ - 33 API Services  │","│ - Firebase         │      │                    │","└────────────────────┘      └────────────────────┘","          │                           │","┌─────────▼──────────┐      ┌─────────▼──────────┐","│ repoDependency     │      │ viewmodelDependency│","│ - 34 Repositories  │      │ - 37 ViewModels    │","└────────────────────┘      └────────────────────┘","          │                           │","          └───────────┬───────────────┘","                      │","          ┌───────────▼────────────┐","          │  Koin Container        │","          │  (Dependency Graph)    │","          └───────────┬────────────┘","                      │","          ┌───────────▼────────────┐","          │  iOS Access via        │","          │  DIHelper()            │","          │  or direct injection   │","          └────────────────────────┘"],"syntax":null},{"type":"thematicBreak"},{"text":"Key Components","anchor":"Key-Components","level":2,"type":"heading"},{"level":3,"anchor":"1-Dashboard-Module","type":"heading","text":"1. Dashboard Module"},{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Location"}]},{"type":"text","text":": "},{"type":"codeVoice","code":"\/Presentation\/Home\/Dashboard\/"}]},{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Responsibilities"}]},{"type":"text","text":":"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Company selection and switching"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Display dashboard statistics (sales, purchases, expenses)"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Financial year management"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Quick actions (Create Bill, Add Party)"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Deep link handling"}],"type":"paragraph"}]}]},{"inlineContent":[{"type":"strong","inlineContent":[{"text":"Key Files","type":"text"}]},{"text":":","type":"text"}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"DashboardView.swift"},{"type":"text","text":" - Main UI"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"DashboardVM.swift"},{"text":" - iOS ViewModel extension","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"code":"shared.DashboardViewModel","type":"codeVoice"},{"type":"text","text":" - KMM ViewModel"}]}]}]},{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Features"}]},{"type":"text","text":":"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Real-time stats updates"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Company switcher"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Financial year picker","type":"text"}]}]},{"content":[{"inlineContent":[{"text":"Quick access to common actions","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"Notification badge handling","type":"text"}],"type":"paragraph"}]}]},{"type":"heading","anchor":"2-BillsDocuments-Module","text":"2. Bills\/Documents Module","level":3},{"inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Location"}]},{"text":": ","type":"text"},{"type":"codeVoice","code":"\/Presentation\/Home\/Bills\/"}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Sub-modules"}]},{"text":":","type":"text"}]},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"CreateBill"}]},{"type":"text","text":": Invoice\/Purchase creation with line items"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"inlineContent":[{"type":"text","text":"DocumentDetails"}],"type":"strong"},{"type":"text","text":": View\/edit existing documents"}]}]},{"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"EWayBills"}]},{"text":": GST e-way bill generation (India-specific)","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"inlineContent":[{"type":"text","text":"DocumentList"}],"type":"strong"},{"type":"text","text":": Transaction listings with filters"}]}]}]},{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Key ViewModels"}]},{"type":"text","text":":"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"CreateBillVM"},{"type":"text","text":" - Document creation logic"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"DocumentsDetailsVM"},{"text":" - Document viewing\/editing","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"EWayBillsViewModel"},{"type":"text","text":" - E-way bill management"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"DocumentVM"},{"type":"text","text":" - Document list & filtering"}]}]}]},{"type":"paragraph","inlineContent":[{"inlineContent":[{"type":"text","text":"Features"}],"type":"strong"},{"type":"text","text":":"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Multi-line item support"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Tax calculation (GST, VAT)","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Discount application"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Payment terms"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Signature capture"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"PDF generation"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"E-invoicing integration"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"E-way bill generation"}]}]}]},{"text":"3. Products Module","type":"heading","level":3,"anchor":"3-Products-Module"},{"type":"paragraph","inlineContent":[{"inlineContent":[{"text":"Location","type":"text"}],"type":"strong"},{"type":"text","text":": "},{"code":"\/Presentation\/Home\/Products\/","type":"codeVoice"}]},{"type":"paragraph","inlineContent":[{"inlineContent":[{"text":"Responsibilities","type":"text"}],"type":"strong"},{"type":"text","text":":"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Product catalog management"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Inventory tracking"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Batch\/serial number handling"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Product variants"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Product grouping"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"HSN code management"}]}]}]},{"type":"paragraph","inlineContent":[{"inlineContent":[{"text":"Key ViewModels","type":"text"}],"type":"strong"},{"type":"text","text":":"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"code":"ProductsViewmodel","type":"codeVoice"},{"type":"text","text":" - Product list & CRUD"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"code":"VariantVM","type":"codeVoice"},{"type":"text","text":" - Product variants management"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"code":"SearchProductVM","type":"codeVoice"},{"type":"text","text":" - Product search"}]}]}]},{"type":"paragraph","inlineContent":[{"inlineContent":[{"text":"Features","type":"text"}],"type":"strong"},{"type":"text","text":":"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Bulk product import"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Product variants (size, color, etc.)"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Inventory timeline tracking"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Low stock alerts"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Barcode scanning"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Product custom columns"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Multi-unit support"}]}]}]},{"text":"4. Parties Module","type":"heading","level":3,"anchor":"4-Parties-Module"},{"type":"paragraph","inlineContent":[{"inlineContent":[{"text":"Location","type":"text"}],"type":"strong"},{"type":"text","text":": "},{"code":"\/Presentation\/Home\/Parties\/","type":"codeVoice"}]},{"type":"paragraph","inlineContent":[{"inlineContent":[{"text":"Sub-modules","type":"text"}],"type":"strong"},{"type":"text","text":":"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Customers"}]},{"type":"text","text":": Customer management"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Vendors"}]},{"type":"text","text":": Vendor management"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Ledger"}]},{"type":"text","text":": Party transaction history"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"PartyPayments"}]},{"type":"text","text":": Payment recording"}]}]}]},{"type":"paragraph","inlineContent":[{"inlineContent":[{"text":"Key ViewModels","type":"text"}],"type":"strong"},{"type":"text","text":":"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"code":"CustomersVM","type":"codeVoice"},{"type":"text","text":" - Customer CRUD"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"code":"VendorsVM","type":"codeVoice"},{"type":"text","text":" - Vendor CRUD"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"code":"LedgerVM","type":"codeVoice"},{"type":"text","text":" - Transaction ledger"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"code":"PartyPaymentsVM","type":"codeVoice"},{"type":"text","text":" - Payment management"}]}]}]},{"type":"paragraph","inlineContent":[{"inlineContent":[{"text":"Features","type":"text"}],"type":"strong"},{"type":"text","text":":"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Party CRUD operations"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Billing\/shipping addresses"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Credit limit management"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Outstanding balance tracking"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Payment history"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Party merge functionality"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Bulk party import"}]}]}]},{"type":"heading","level":3,"text":"5. Settings\/More Module","anchor":"5-SettingsMore-Module"},{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Location"}]},{"type":"text","text":": "},{"type":"codeVoice","code":"\/Presentation\/Home\/More\/"}]},{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Settings Categories"}]},{"type":"text","text":":"}]},{"items":[{"content":[{"inlineContent":[{"type":"text","text":"Company details"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Invoice settings (templates, numbering)"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Document settings (terms, notes)"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Bank details"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Signatures"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"General settings"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Product custom columns"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Inventory timeline","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Auto reminders","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"User profile","type":"text"}]}]}],"type":"unorderedList"},{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"text":"Key Features","type":"text"}]},{"text":":","type":"text"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Multi-company management"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Custom invoice templates"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Auto-increment invoice numbers"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Default payment terms","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Company logo upload","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Digital signature management"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Tax settings (GST, VAT)","type":"text"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Currency settings"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Language preferences"}]}]}]},{"type":"heading","level":3,"text":"6. In-App Purchases Module","anchor":"6-In-App-Purchases-Module"},{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Location"}]},{"type":"text","text":": "},{"code":"\/Presentation\/IAP\/","type":"codeVoice"}]},{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Responsibilities"}]},{"type":"text","text":":"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Subscription management"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Transaction validation"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Receipt handling"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Plan upgrade flows"}]}]}]},{"inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Key Components"}]},{"text":":","type":"text"}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"StoreKitService.swift"},{"text":" - IAP logic","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"SubscriptionView.swift"},{"type":"text","text":" - Subscription UI"}]}]},{"content":[{"inlineContent":[{"code":"PlanComparisonView.swift","type":"codeVoice"},{"text":" - Plan comparison","type":"text"}],"type":"paragraph"}]}]},{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Features"}]},{"text":":","type":"text"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Monthly\/yearly subscriptions"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Free trial support"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Promo codes","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Subscription restoration"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Receipt validation"}]}]},{"content":[{"inlineContent":[{"text":"Backend sync","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Transaction history"}]}]}]},{"anchor":"7-Analytics-Module","type":"heading","text":"7. Analytics Module","level":3},{"type":"paragraph","inlineContent":[{"inlineContent":[{"text":"Location","type":"text"}],"type":"strong"},{"type":"text","text":": "},{"code":"\/Analytics\/","type":"codeVoice"}]},{"type":"paragraph","inlineContent":[{"inlineContent":[{"text":"Tracking Events","type":"text"}],"type":"strong"},{"type":"text","text":":"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Screen views"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"User actions (create bill, add party)"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Feature usage"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Conversion events"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Errors and crashes"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Performance metrics"}]}]}]},{"type":"paragraph","inlineContent":[{"inlineContent":[{"type":"text","text":"Integrations"}],"type":"strong"},{"type":"text","text":":"}]},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"text","text":"Firebase Analytics"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"Firebase Crashlytics","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Microsoft Clarity","type":"text"}]}]}]},{"inlineContent":[{"type":"strong","inlineContent":[{"text":"Key Features","type":"text"}]},{"type":"text","text":":"}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"Protocol-based abstraction","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Type-safe event logging","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"User property tracking","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"No PII in events","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"A\/B testing support (Firebase Remote Config)","type":"text"}]}]}]},{"type":"thematicBreak"},{"text":"Third-Party Dependencies","level":2,"anchor":"Third-Party-Dependencies","type":"heading"},{"text":"iOS Dependencies (CocoaPods)","level":3,"anchor":"iOS-Dependencies-CocoaPods","type":"heading"},{"rows":[[[{"inlineContent":[{"text":"Pod","type":"text"}],"type":"paragraph"}],[{"inlineContent":[{"type":"text","text":"Version"}],"type":"paragraph"}],[{"inlineContent":[{"type":"text","text":"Purpose"}],"type":"paragraph"}]],[[{"inlineContent":[{"type":"text","text":"AEOTPTextField"}],"type":"paragraph"}],[{"inlineContent":[{"type":"text","text":"1.2.6"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"OTP input field"}]}]],[[{"inlineContent":[{"type":"text","text":"RichEditorView"}],"type":"paragraph"}],[{"inlineContent":[{"text":"4.0","type":"text"}],"type":"paragraph"}],[{"inlineContent":[{"type":"text","text":"Rich text editing (custom fork)"}],"type":"paragraph"}]],[[{"inlineContent":[{"text":"Smartech-iOS-SDK","type":"text"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"text":"3.5.5","type":"text"}]}],[{"type":"paragraph","inlineContent":[{"text":"Push notifications & analytics","type":"text"}]}]]],"header":"row","type":"table"},{"text":"iOS Dependencies (SPM - Inferred)","level":3,"anchor":"iOS-Dependencies-SPM-Inferred","type":"heading"},{"rows":[[[{"type":"paragraph","inlineContent":[{"text":"Package","type":"text"}]}],[{"type":"paragraph","inlineContent":[{"text":"Purpose","type":"text"}]}]],[[{"type":"paragraph","inlineContent":[{"text":"Firebase Core","type":"text"}]}],[{"type":"paragraph","inlineContent":[{"text":"Firebase initialization","type":"text"}]}]],[[{"type":"paragraph","inlineContent":[{"text":"Firebase Crashlytics","type":"text"}]}],[{"type":"paragraph","inlineContent":[{"text":"Crash reporting","type":"text"}]}]],[[{"type":"paragraph","inlineContent":[{"text":"Firebase Messaging","type":"text"}]}],[{"type":"paragraph","inlineContent":[{"text":"Push notifications","type":"text"}]}]],[[{"type":"paragraph","inlineContent":[{"text":"Firebase Analytics","type":"text"}]}],[{"type":"paragraph","inlineContent":[{"text":"Analytics tracking","type":"text"}]}]],[[{"type":"paragraph","inlineContent":[{"text":"Firebase Performance","type":"text"}]}],[{"type":"paragraph","inlineContent":[{"text":"Performance monitoring","type":"text"}]}]],[[{"type":"paragraph","inlineContent":[{"text":"Firebase Remote Config","type":"text"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Feature flags"}]}]],[[{"type":"paragraph","inlineContent":[{"type":"text","text":"RealmSwift"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Local database"}]}]],[[{"type":"paragraph","inlineContent":[{"type":"text","text":"SDWebImage"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Image caching"}]}]],[[{"type":"paragraph","inlineContent":[{"type":"text","text":"SDWebImageSwiftUI"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"SwiftUI image loading"}]}]],[[{"type":"paragraph","inlineContent":[{"type":"text","text":"IQKeyboardManagerSwift"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Keyboard handling"}]}]],[[{"type":"paragraph","inlineContent":[{"type":"text","text":"Intercom"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Customer support chat"}]}]],[[{"type":"paragraph","inlineContent":[{"type":"text","text":"CobrowseIO"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Co-browsing support"}]}]]],"header":"row","type":"table"},{"text":"KMM Dependencies (Gradle)","level":3,"anchor":"KMM-Dependencies-Gradle","type":"heading"},{"rows":[[[{"type":"paragraph","inlineContent":[{"type":"text","text":"Library"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Version"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Purpose"}]}]],[[{"type":"paragraph","inlineContent":[{"type":"text","text":"Ktor Client"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Latest"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Cross-platform HTTP client"}]}]],[[{"type":"paragraph","inlineContent":[{"type":"text","text":"Koin"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Latest"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Dependency injection"}]}]],[[{"type":"paragraph","inlineContent":[{"type":"text","text":"MOKO MVVM"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"0.15.0"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"ViewModel framework"}]}]],[[{"type":"paragraph","inlineContent":[{"type":"text","text":"MOKO KSwift"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"0.6.1"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Swift API generation"}]}]],[[{"type":"paragraph","inlineContent":[{"type":"text","text":"kotlinx.serialization"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"1.5.1"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"JSON serialization"}]}]],[[{"type":"paragraph","inlineContent":[{"type":"text","text":"multiplatform-settings"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"1.0.0"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Shared preferences"}]}]],[[{"type":"paragraph","inlineContent":[{"type":"text","text":"KMP Native Coroutines"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"1.0.0-ALPHA-10"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Coroutines for iOS"}]}]],[[{"type":"paragraph","inlineContent":[{"type":"text","text":"swipe-calculation-engine"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"0.2.0.21-beta"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Business logic calculations"}]}]]],"header":"row","type":"table"},{"text":"Framework Versions","level":3,"anchor":"Framework-Versions","type":"heading"},{"code":["\/\/ build.gradle.kts","kotlin(\"multiplatform\") version \"1.9.10\"","android.gradle.plugin version \"8.1.2\""],"type":"codeListing","syntax":"kotlin"},{"type":"thematicBreak"},{"text":"Build Configuration","level":2,"anchor":"Build-Configuration","type":"heading"},{"text":"iOS Build Configuration","level":3,"anchor":"iOS-Build-Configuration","type":"heading"},{"inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Xcode Project"}]},{"type":"text","text":": "},{"type":"codeVoice","code":"Swipe.xcodeproj"},{"type":"text","text":" "},{"type":"strong","inlineContent":[{"type":"text","text":"Workspace"}]},{"type":"text","text":": "},{"type":"codeVoice","code":"Swipe.xcworkspace"}],"type":"paragraph"},{"inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Targets"}]},{"type":"text","text":":"}],"type":"paragraph"},{"type":"orderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Swipe"}]},{"text":" - Main application","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"NotificationService"}]},{"text":" - Rich notification handling","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"SwipeWidget"}]},{"text":" - Home screen widget","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"SmartechNSEContent"}]},{"text":" - Smartech notification extension","type":"text"}]}]}]},{"inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Bundle Identifier"}]},{"type":"text","text":": "},{"type":"codeVoice","code":"com.swipe.mac"}],"type":"paragraph"},{"inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Configurations"}]},{"type":"text","text":":"}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"Debug","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Release","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"TestFlight (custom)","type":"text"}]}]}]},{"inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Build Phases"}]},{"type":"text","text":":"}],"type":"paragraph"},{"type":"orderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"Compile Swift sources","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Link KMM framework","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Embed frameworks"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Copy resources"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Run CocoaPods script"}]}]}]},{"text":"KMM Build Configuration","level":3,"anchor":"KMM-Build-Configuration","type":"heading"},{"inlineContent":[{"inlineContent":[{"type":"text","text":"Build File"}],"type":"strong"},{"text":": ","type":"text"},{"code":"shared\/build.gradle.kts","type":"codeVoice"}],"type":"paragraph"},{"inlineContent":[{"inlineContent":[{"type":"text","text":"iOS Framework Configuration"}],"type":"strong"},{"text":":","type":"text"}],"type":"paragraph"},{"code":["cocoapods {","    summary = \"Shared module for Swipe\"","    homepage = \"Link to the Shared Module homepage\"","    ios.deploymentTarget = \"14.0\"","","    framework {","        baseName = \"shared\"","        isStatic = true","        export(libs.mokoMvvmCore)","        export(libs.mokoMvvmLiveData)","        export(libs.mokoMvvmLiveDataResources)","        export(libs.mokoMvvmState)","    }","}"],"type":"codeListing","syntax":"kotlin"},{"inlineContent":[{"inlineContent":[{"type":"text","text":"iOS Targets"}],"type":"strong"},{"text":":","type":"text"}],"type":"paragraph"},{"code":["val iosX64 = iosX64()","val iosArm64 = iosArm64()","val iosSimulatorArm64 = iosSimulatorArm64()"],"type":"codeListing","syntax":"kotlin"},{"inlineContent":[{"inlineContent":[{"type":"text","text":"Gradle Tasks"}],"type":"strong"},{"text":":","type":"text"}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":".\/gradlew :shared:linkDebugFrameworkIosArm64"},{"type":"text","text":" - Build for devices"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":".\/gradlew :shared:linkDebugFrameworkIosX64"},{"type":"text","text":" - Build for Intel simulator"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":".\/gradlew :shared:linkDebugFrameworkIosSimulatorArm64"},{"type":"text","text":" - Build for M1\/M2 simulator"}]}]}]},{"type":"thematicBreak"},{"text":"Security","level":2,"anchor":"Security","type":"heading"},{"text":"1. Authentication & Token Management","level":3,"anchor":"1-Authentication--Token-Management","type":"heading"},{"inlineContent":[{"inlineContent":[{"type":"text","text":"Token Storage"}],"type":"strong"},{"text":":","type":"text"}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Previously"}]},{"type":"text","text":": UserDefaults (being migrated)"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Currently"}]},{"type":"text","text":": Keychain via "},{"type":"codeVoice","code":"KeychainManager"}]}]}]},{"inlineContent":[{"inlineContent":[{"type":"text","text":"KeychainManager Implementation"}],"type":"strong"},{"type":"text","text":":"}],"type":"paragraph"},{"syntax":"swift","code":["func saveToken(_ token: String) -> Result<Void, KeychainError> {","    let data = Data(token.utf8)","    let query: [String: Any] = [","        kSecClass as String: kSecClassGenericPassword,","        kSecAttrService as String: service,","        kSecAttrAccount as String: account,","        kSecValueData as String: data,","        kSecAttrAccessible as String: kSecAttrAccessibleWhenUnlockedThisDeviceOnly","    ]","","    \/\/ Delete existing item first","    SecItemDelete(query as CFDictionary)","","    let status = SecItemAdd(query as CFDictionary, nil)","    return status == errSecSuccess ? .success(()) : .failure(.saveFailed(status))","}"],"type":"codeListing"},{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Security Features"}]},{"text":":","type":"text"}]},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"code":"kSecAttrAccessibleWhenUnlockedThisDeviceOnly","type":"codeVoice"},{"type":"text","text":" - Token only accessible when device unlocked"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Not backed up to iCloud"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Device-specific storage","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Automatic cleanup on app deletion","type":"text"}]}]}]},{"type":"heading","level":3,"anchor":"2-Network-Security","text":"2. Network Security"},{"type":"paragraph","inlineContent":[{"inlineContent":[{"type":"text","text":"HTTPS Only"}],"type":"strong"},{"type":"text","text":":"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"All API calls use HTTPS","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"TLS 1.2+ required","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Certificate pinning (recommended for future)","type":"text"}]}]}]},{"type":"paragraph","inlineContent":[{"inlineContent":[{"type":"text","text":"Request Headers"}],"type":"strong"},{"type":"text","text":":"}]},{"type":"codeListing","syntax":"kotlin","code":["defaultRequest {","    header(\"Authorization\", \"Bearer $token\")","    header(\"Device_Fingerprint\", Utils.getDeviceId())","    header(\"User-Agent\", Utils.getUserAgent())","    header(\"Request-Timestamp\", Utils.getCurrentDateTime())","    header(\"X-Request-ID\", Utils.getPlatformUniqueId())","}"]},{"type":"paragraph","inlineContent":[{"inlineContent":[{"type":"text","text":"Security Measures"}],"type":"strong"},{"type":"text","text":":"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"Bearer token authentication","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Device fingerprinting","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Request ID tracking","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Timestamp validation","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"User-Agent verification","type":"text"}]}]}]},{"type":"heading","level":3,"anchor":"3-Data-Protection","text":"3. Data Protection"},{"type":"paragraph","inlineContent":[{"inlineContent":[{"type":"text","text":"Local Data"}],"type":"strong"},{"type":"text","text":":"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"Realm database encrypted (optional, recommended)","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Keychain for sensitive credentials","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"UserDefaults for non-sensitive preferences","type":"text"}]}]}]},{"type":"paragraph","inlineContent":[{"inlineContent":[{"type":"text","text":"PII Handling"}],"type":"strong"},{"type":"text","text":":"}]},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"text":"No PII in analytics events","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"User consent for data collection","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"GDPR compliance measures"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"Data export capability"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Data deletion support","type":"text"}]}]}]},{"type":"heading","level":3,"anchor":"4-Session-Management","text":"4. Session Management"},{"type":"paragraph","inlineContent":[{"inlineContent":[{"type":"text","text":"Automatic Logout"}],"type":"strong"},{"text":":","type":"text"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"401 response triggers logout"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Session timeout handling","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Token refresh mechanism (if implemented)","type":"text"}]}]}]},{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Security Best Practices"}]},{"type":"text","text":":"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"No credentials stored in UserDefaults","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Secure token transmission"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Automatic session cleanup"}]}]}]},{"type":"thematicBreak"},{"inlineContent":[{"identifier":"development-setup.md","type":"reference","isActive":true},{"text":" | ","type":"text"},{"identifier":"..\/README.md","type":"reference","isActive":true},{"text":" | ","type":"text"},{"identifier":"coding-standards.md","type":"reference","isActive":true}],"type":"paragraph"}]}],"references":{"doc://com.rachna.docs31212/documentation/Documentation":{"type":"topic","title":"Documentation","role":"collection","identifier":"doc:\/\/com.rachna.docs31212\/documentation\/Documentation","kind":"article","abstract":[],"url":"\/documentation\/documentation"},"#build-configuration":{"type":"link","title":"Build Configuration","identifier":"#build-configuration","titleInlineContent":[{"type":"text","text":"Build Configuration"}],"url":"#build-configuration"},"#third-party-dependencies":{"type":"link","title":"Third-Party Dependencies","identifier":"#third-party-dependencies","titleInlineContent":[{"type":"text","text":"Third-Party Dependencies"}],"url":"#third-party-dependencies"},"#key-components":{"type":"link","title":"Key Components","identifier":"#key-components","titleInlineContent":[{"type":"text","text":"Key Components"}],"url":"#key-components"},"#project-structure":{"type":"link","title":"Project Structure","identifier":"#project-structure","titleInlineContent":[{"type":"text","text":"Project Structure"}],"url":"#project-structure"},"#kmm-architecture":{"type":"link","title":"KMM Architecture","identifier":"#kmm-architecture","titleInlineContent":[{"type":"text","text":"KMM Architecture"}],"url":"#kmm-architecture"},"#data-flow":{"type":"link","title":"Data Flow","identifier":"#data-flow","titleInlineContent":[{"type":"text","text":"Data Flow"}],"url":"#data-flow"},"coding-standards.md":{"type":"link","title":"Next: Coding Standards →","identifier":"coding-standards.md","titleInlineContent":[{"type":"text","text":"Next: Coding Standards →"}],"url":"coding-standards.md"},"#ios-architecture":{"type":"link","title":"iOS Architecture","identifier":"#ios-architecture","titleInlineContent":[{"type":"text","text":"iOS Architecture"}],"url":"#ios-architecture"},"development-setup.md":{"type":"link","title":"← Previous: Development Setup","identifier":"development-setup.md","titleInlineContent":[{"type":"text","text":"← Previous: Development Setup"}],"url":"development-setup.md"},"#module-dependencies":{"type":"link","title":"Module Dependencies","titleInlineContent":[{"type":"text","text":"Module Dependencies"}],"url":"#module-dependencies","identifier":"#module-dependencies"},"../README.md":{"titleInlineContent":[{"type":"text","text":"Back to Index"}],"identifier":"..\/README.md","title":"Back to Index","url":"..\/README.md","type":"link"},"#security":{"url":"#security","type":"link","title":"Security","titleInlineContent":[{"text":"Security","type":"text"}],"identifier":"#security"},"#architectural-patterns":{"titleInlineContent":[{"type":"text","text":"Architectural Patterns"}],"identifier":"#architectural-patterns","title":"Architectural Patterns","url":"#architectural-patterns","type":"link"}}}